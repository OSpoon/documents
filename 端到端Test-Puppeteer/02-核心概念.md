## ðŸ‘‹ Hi, Nice to meet you ~

æˆ‘æ˜¯å°é‘«åŒå­¦ï¼Œåœ¨åŒ—äº¬å·¥ä½œçš„ä¸€ä½å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆã€‚æˆ‘æ“…é•¿ä½¿ç”¨ [Vue.js](https://cn.vuejs.org/)ã€ [Angular](https://angular.cn/)ã€ [Typescript](https://www.typescriptlang.org/) å’Œ [Node.js](https://www.nodejs.com.cn/) æž„å»º [Web](https://developer.mozilla.org/zh-CN/docs/Web) åº”ç”¨ç¨‹åºå’Œç½‘ç«™ã€‚åŒæ—¶æˆ‘ä¹Ÿæ˜¯ä¸€ä½ä¹äºŽåˆ†äº«çš„ç¨‹åºå‘˜ï¼Œæˆ‘ç»å¸¸åˆ©ç”¨ä¼‘æ¯æ—¶é—´å†™å†™æŠ€æœ¯æ–‡ç« ã€åˆ†äº«è‡ªå·±ç»éªŒåŠå­¦ä¹ å¿ƒå¾—ã€‚

è¿‘ä¸¤å¹´ä¸»è¦åˆ©ç”¨ [MicroApp](https://micro-zoe.github.io/micro-app/) å¾®å‰ç«¯æ¡†æž¶ç»´æŠ¤å’Œè¿­ä»£å…¬å¸çš„é¡¹ç›®ï¼Œä¿è¯åŽ†å²çš„ [Angular](https://angular.cn/) å·¥ç¨‹é€æ­¥å‘ [Vue.js](https://cn.vuejs.org/) çš„å¹³ç¨³è¿ç§»ã€‚

åº§å³é“­: ðŸ˜‡ æ‰€æœ‰ä»˜å‡ºéƒ½å°†æ˜¯æ²‰æ·€ï¼Œæ‰€æœ‰ç¾Žå¥½ç»ˆä¼šå¦‚æœŸè€Œè‡³

# æ ¸å¿ƒæ¦‚å¿µ

* æµè§ˆå™¨ç®¡ç†
* é¡µé¢äº¤äº’
* JavaScript æ‰§è¡Œå™¨
* ç½‘ç»œä¾¦å¬

## æµè§ˆå™¨ç®¡ç†ï¼š

1. **å¯åŠ¨æµè§ˆå™¨**

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
     	// å¯åŠ¨æµè§ˆå™¨
       const browser = await puppeteer.launch()
       const page = await browser.newPage()
   })()
   ```

2. **å…³é—­æµè§ˆå™¨**

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.launch()
       const page = await browser.newPage()
       // å…³é—­æµè§ˆå™¨
       await browser.close()
   })()
   ```

3. **ä¸Šä¸‹æ–‡**ï¼šç”¨æ¥éš”ç¦»è‡ªåŠ¨åŒ–ä»»åŠ¡ä¸­ Cookie å’Œ æœ¬åœ°å­˜å‚¨å…±äº«çš„é—®é¢˜ï¼Œå½“ä¸Šä¸‹æ–‡å…³é—­æ—¶æ‰€å…³è”çš„é¡µé¢ä¼šä¸€åŒå…³é—­ï¼›

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.launch()
       // Cookie å’Œ æœ¬åœ°å­˜å‚¨åªä¼šåœ¨æ­¤ä¸Šä¸‹æ–‡ä¸­å…±äº«
       const context = await browser.createBrowserContext()
       
       const page1 = await context.newPage()
       const page2 = await context.newPage()
   
       await context.close()
   })()
   ```

4. **ä¸Šä¸‹æ–‡æƒé™**ï¼šä¾‹å¦‚åœ¨ç¬¬ä¸€æ¬¡è®¿é—®é«˜å¾·åœ°å›¾æ—¶æµè§ˆå™¨ä¼šæç¤ºä½ æ‰‹åŠ¨å¼€å¯å®šä½æƒé™ï¼Œå¦‚é‡åˆ°ç±»ä¼¼æƒ…å†µï¼Œå°±å¯ä»¥æ‰§è¡Œ `overridePermissions()` å‡½æ•°æå‰é…ç½®æƒé™ï¼›

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.launch({
           headless: false,
       })
       const context = await browser.defaultBrowserContext()
       
       const url = 'https://ditu.amap.com/'
       await context.overridePermissions(url, ['geolocation'])
       
       const page = await context.newPage()
       await page.goto(url)
   })()
   ```

5. è¿žæŽ¥åˆ°æ­£åœ¨è¿è¡Œçš„æµè§ˆå™¨

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
     	// æºå¸¦è¿œç¨‹è°ƒè¯•ç«¯å£å‚æ•°æ‰“å¼€ç¬¬ä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œå¹¶å¯¼èˆªåˆ°å¦‚ä¸‹åœ°å€èŽ·å– webSocketDebuggerUrl
       const browser = await puppeteer.launch({
           headless: false,
           args: ['--remote-debugging-port=9222']
       })
       const page = await browser.newPage()
       await page.goto('http://localhost:9222/json/version')
   })()
   ```

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.connect({
           headless: false,
           browserWSEndpoint: '' // å°† webSocketDebuggerUrl å¡«å†™åˆ°æ­¤ï¼Œå¹¶è¿žæŽ¥ç¬¬ä¸€ä¸ªæµè§ˆå™¨çª—å£
       })
   
       await browser.newPage()
     	// ä»»åŠ¡å¤„ç†å®Œæ¯•åŽå¯æ–­å¼€è¿žæŽ¥è€Œä¸ä¼šå…³é—­æµè§ˆå™¨çª—å£
     	browser.disconnect()
   })()
   ```

## é¡µé¢äº¤äº’ï¼š

Puppeteer å…è®¸é€šè¿‡é¼ æ ‡ã€è§¦æ‘¸äº‹ä»¶å’Œé”®ç›˜è¾“å…¥ä¸Žé¡µé¢ä¸Šçš„å…ƒç´ è¿›è¡Œäº¤äº’ã€‚é€šè¿‡ï¼Œé¦–é€‰ CSS é€‰æ‹©å™¨æŸ¥è¯¢ DOM å…ƒç´ ï¼Œç„¶åŽå¯¹å…ƒç´ è°ƒç”¨æ“ä½œã€‚é™¤ CSS é€‰æ‹©å™¨è¢« Puppeteer é»˜è®¤ API æ”¯æŒä»¥å¤–ï¼Œè¿˜æä¾›äº†è‡ªåŠ¨ä»¥é€‰æ‹©å™¨è¯­æ³•ï¼Œå…è®¸ä½¿ç”¨ XPathã€Textã€Accessibility å±žæ€§æŸ¥æ‰¾å…ƒç´ å¹¶è®¿é—® Shadow DOMã€‚

### å®šä½å™¨ï¼š

å®šä½å™¨ï¼ˆLocatorsï¼‰æ˜¯é€‰æ‹©å…ƒç´ å¹¶ä¸Žä¹‹äº¤äº’çš„æŽ¨èæ–¹å¼ï¼Œå®šä½å™¨ API æ”¯æŒ Puppeteer è‡ªåŠ¨ç­‰å¾…å…ƒç´ åœ¨ DOM ä¸­å¤„äºŽå¯æ“ä½œçš„æ­£ç¡®çŠ¶æ€ã€‚å½“ å®šä½å™¨ API æ— æ³•æ»¡è¶³è¦æ±‚æ—¶ä»å¯ä»¥ä½¿ç”¨ä½Žçº§åˆ«çš„ APIï¼Œä¾‹å¦‚ï¼š`page.waitForSelector()` æˆ– `ElementHandle`ã€‚

1. ä½¿ç”¨å®šä½å™¨å•æœºå…ƒç´ ï¼š

   ```javascript
   await page.locator('button').click();
   ```

   PSï¼šå®šä½å™¨ä¼šåœ¨å•å‡»å‰è‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

   * ç¡®ä¿å…ƒç´ ä½äºŽè§†å£ä¸­
   * ç­‰å¾…å…ƒç´ å˜å¾—å¯è§æˆ–éšè—
   * ç­‰å¾…å…ƒç´ å¯ç”¨
   * ç­‰å¾…å…ƒç´ åœ¨ä¸¤ä¸ªè¿žç»­çš„åŠ¨ç”»å¸§ä¸Šå…·æœ‰ç¨³å®šçš„è¾¹ç•Œæ¡†

2. ä½¿ç”¨å®šä½å™¨å½•å…¥å†…å®¹ï¼š

   ```javascript
   await page.locator('input').fill('hello world');
   ```

   PSï¼šå®šä½å™¨ä¼šåœ¨è¾“å…¥å‰è‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

   * ç¡®ä¿å…ƒç´ ä½äºŽè§†å£ä¸­
   * ç­‰å¾…å…ƒç´ å˜å¾—å¯è§æˆ–éšè—
   * ç­‰å¾…å…ƒç´ å¯ç”¨
   * ç­‰å¾…å…ƒç´ åœ¨ä¸¤ä¸ªè¿žç»­çš„åŠ¨ç”»å¸§ä¸Šå…·æœ‰ç¨³å®šçš„è¾¹ç•Œæ¡†

3. ä½¿ç”¨å®šä½å™¨å®žçŽ°é¼ æ ‡æ‚¬åœï¼ˆhoverï¼‰ï¼š

   ```javascript
   await page.locator('div').hover();
   ```

   PSï¼šå®šä½å™¨ä¼šåœ¨æ‚¬åœå‰è‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

   * ç¡®ä¿å…ƒç´ ä½äºŽè§†å£ä¸­
   * ç­‰å¾…å…ƒç´ å˜å¾—å¯è§æˆ–éšè—
   * ç­‰å¾…å…ƒç´ åœ¨ä¸¤ä¸ªè¿žç»­çš„åŠ¨ç”»å¸§ä¸Šå…·æœ‰ç¨³å®šçš„è¾¹ç•Œæ¡†ã€‚

4. ä½¿ç”¨å®šä½å™¨æ»šåŠ¨å…ƒç´ ï¼š

   ```javascript
   await page.locator('div').scroll({
       scrollTop: 10,
       scrollLeft: 20
   });
   ```

   PSï¼šå®šä½å™¨ä¼šåœ¨æ»šåŠ¨å‰è‡ªåŠ¨æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

   * ç¡®ä¿å…ƒç´ ä½äºŽè§†å£ä¸­
   * ç­‰å¾…å…ƒç´ å˜å¾—å¯è§æˆ–éšè—
   * ç­‰å¾…å…ƒç´ åœ¨ä¸¤ä¸ªè¿žç»­çš„åŠ¨ç”»å¸§ä¸Šå…·æœ‰ç¨³å®šçš„è¾¹ç•Œæ¡†

5. ä½¿ç”¨å®šä½å™¨ç­‰å¾…å…ƒç´ å¯è§ï¼š

   ```javascript
   await page.locator('.loading').wait();
   ```

   PSï¼šå®šä½å™¨åœ¨è¿”å›žå‰ä¼šæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

   * ç­‰å¾…å…ƒç´ å˜å¾—å¯è§æˆ–éšè—

6. ä½¿ç”¨å®šä½å™¨å®žçŽ°ç­‰å¾…å‡½æ•°ï¼š

   ç¤ºä¾‹ä¸­å±•ç¤ºäº†ä½¿ç”¨å®šä½å™¨å®žçŽ° JavaScript å‡½æ•° ç­‰å¾… `MutationObserver` æ£€æµ‹é¡µé¢å‡ºçŽ° `MutationObserver` å…ƒç´ ï¼š

   ```javascript
   await page.locator(() => {
       let resolve;
       const promise = new Promise((res) => {
           return (resolve = res)
       });
       const observer = new MutationObserver((records) => {
           for (const record of records) {
               if (record.target instanceof HTMLCanvasElement) {
                   resolve(record.target);
               }
           }
       });
       observer.observe(document);
       return promise;
   }).wait()
   ```

7. å®šä½å™¨ä¸Žè¿‡æ»¤å™¨é…åˆï¼š

   ç¤ºä¾‹ä¸­å±•ç¤ºäº†ä½¿ç”¨å®šä½å™¨åŒ¹é… `button` ä¸”é€šè¿‡è¿‡æ»¤å™¨å†æ¬¡åŒ¹é… `button` æ–‡æœ¬ä¸­åŒ…å« `Click Me` çš„å…ƒç´ ï¼Œæœ€åŽæ‰ä¼šç‚¹å‡»æ­¤å…ƒç´ ã€‚

   ```javascript
   await page.locator('button')
   	.filter(el = el.innerText().includes('Click Me'))
     .click();
   ```

8. ä»Žå®šä½å™¨èŽ·å–å€¼ï¼š

   ä½¿ç”¨ `map` å‡½æ•°å°†å…ƒç´ æ˜ å°„ä¸º JavaScript å€¼ï¼Œå†è°ƒç”¨ `wait()` å°†è¿”å›žåºåˆ—åŒ–çš„ JavaScript å€¼ï¼š

   ```javascript
   const enabled = await page.locator('button')
   	.map(el => !el.disabled).wait();
   ```

9. ä»Žå®šä½å™¨èŽ·å– ElementHandlesï¼š

   ä½¿ç”¨ `waitHandle()` å‡½æ•°å°†è¿”å›ž ElementHandles å®žä¾‹ã€‚å¦‚æžœå®šä½å™¨å†…ç½® API æ— æ³•æ»¡è¶³æ—¶ï¼Œæ­¤æ“ä½œä¼šå¾ˆæœ‰ç”¨ã€‚

   ```javascript
   const buttonHandle = await page.locator('button').waitHandle();
   await buttonHandle.click();
   ```

10. é…ç½®å®šä½å™¨è‡ªæ£€é¡¹ï¼š

    é…ç½®å®šä½å™¨ä»¥æ”¹å˜å®šä½å™¨é»˜è®¤çš„è‡ªåŠ¨æ£€æŸ¥é¡¹ï¼Œå®žä¾‹ä¸­å°†ä¸åšä»»ä½•æ£€æŸ¥å¯¹æŒ‰é’®è§¦å‘å•å‡»äº‹ä»¶ï¼š

    ```javascript
    await page.locator('button')
      .setEnsureElementIsInTheViewport(false)
      .setVisibility(null)
      .setWaitForEnabled(false)
      .setWaitForStableBoundingBox(false)
      .click();
    ```

11. é…ç½®å®šä½å™¨è¶…æ—¶ï¼š

    ç”±äºŽç½‘é¡µçš„å“åº”é€Ÿåº¦å­˜åœ¨å·®å¼‚ï¼Œé»˜è®¤çš„è¶…æ—¶æ—¶é—´ä¸æ»¡è¶³éœ€è¦çš„æƒ…å†µä¸‹ï¼Œå¯ä½¿ç”¨ `setTimeout()` å‡½æ•°é€‚å½“å»¶é•¿ï¼Œè¶…æ—¶åŽå°†æŠ›å‡º TimeoutError å¼‚å¸¸ï¼š

    ```javascript
    await page.locator('button').setTimeout(5 * 1000).click();
    ```

12. èŽ·å–å®šä½å™¨äº‹ä»¶ï¼š

    ç›®å‰å®šä½å™¨æ”¯æŒä¸€ä¸ªå•ç‹¬çš„äº‹ä»¶ï¼Œäº‹ä»¶ä¼šåœ¨å®šä½å™¨å‡†å¤‡æ‰§è¡ŒæŸé¡¹åŠ¨ä½œå‰è§¦å‘ï¼Œä»¥æ­¤è¡¨ç¤ºæ‰€æœ‰å‰ç½®æ¡ä»¶å·²ç»å¾—åˆ°æ»¡è¶³ï¼Œæ­¤äº‹ä»¶å¯åœ¨æ—¥å¿—è®°å½•æˆ–è°ƒè¯•ç­‰åœºæ™¯å‘æŒ¥ä¸€å®šçš„ä½œç”¨ï¼š

    ```javascript
    await page.locator('button')
      .on(LocatorEvent.Action, () => {
          console.log('clicked');
      }).click();
    ```

### ç­‰å¾…æ‰§è¡Œé€‰æ‹©å™¨ ï¼š

ç­‰å¾…é€‰æ‹©å™¨ï¼ˆwaitForSelectorï¼‰ä¸Žå®šä½å™¨ç›¸æ¯”æ˜¯ä¸€ä¸ªæ¯”è¾ƒä½Žçº§åˆ«çš„ APIï¼Œç­‰å¾…é€‰æ‹©å™¨å…è®¸ç­‰å¾…å…ƒç´ åœ¨ DOM ä¸­å¯ç”¨ä½†ä¸ä¼šè‡ªåŠ¨é‡è¯•è¯¥æ“ä½œï¼Œå¹¶ä¸”éœ€è¦æ‰‹åŠ¨é‡Šæ”¾ç”Ÿæˆçš„ ElementHandle ä»¥é˜²æ­¢å†…å­˜æ³„æ¼ã€‚

```javascript
import pprt from "puppeteer"

(async () => {
    
    const browser = await pprt.launch()
    const page = await browser.newPage()
    await page.goto("URL_ADDRESS")

    // ä½¿ç”¨ waitForSelector æŸ¥è¯¢å¥æŸ„
    const element = await page.waitForSelector("div > .class-name")
    await element.click();

    // æ³¨æ„é‡Šæ”¾èµ„æº
    await element.dispose();

    await browser.close();
    
})()
```

### ç«‹å³æ‰§è¡Œé€‰æ‹©å™¨ï¼š

ç«‹å³æŸ¥è¯¢é€‰æ‹©å™¨æ˜¯ç”± Puppeteer æä¾›æŸ¥è¯¢å·²çŸ¥å­˜åœ¨äºŽé¡µé¢å…ƒç´ çš„ä¸€ç»„ APIï¼š

| API           | æè¿°                                                     |
| :------------ | -------------------------------------------------------- |
| page.$()      | è¿”å›žä¸Žé€‰æ‹©å™¨åŒ¹é…çš„å•ä¸ªå…ƒç´                                |
| page.$$()     | è¿”å›žä¸Žé€‰æ‹©å™¨åŒ¹é…çš„å¤šä¸ªå…ƒç´                                |
| page.$eval()  | è¿”å›žä¸Žé€‰æ‹©å™¨åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸Šè¿è¡Œ JavaScript å‡½æ•°çš„ç»“æžœ |
| page.$$eval() | è¿”å›žä¸Žé€‰æ‹©å™¨åŒ¹é…çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šè¿è¡Œ JavaScript å‡½æ•°çš„ç»“æžœ |

### é€‰æ‹©å™¨æ‰©å±•ï¼š

Puppeteer åœ¨é€‰æ‹©å™¨ API ä¸­æŽ¥å— CSS é€‰æ‹©å™¨ï¼Œæ­¤å¤–è¿˜æ‰©å±•äº†é¢å¤–çš„é€‰æ‹©å™¨è¯­æ³•æ¥ä¸º CSS é€‰æ‹©å™¨æä¾›æ›´å¤šçš„åŠŸèƒ½ã€‚

1. éž CSS é€‰æ‹©å™¨ï¼šPuppeteer è‡ªå®šä¹‰ä¼ªå…ƒç´ æ‰©å±• CSSè¯­æ³•å®žçŽ°éž CSS é€‰æ‹©å™¨é€‰æ‹©å…ƒç´ ã€‚

   1. XPath é€‰æ‹©å™¨ï¼ˆ`-p-path`ï¼‰ï¼š

      ```javascript
      import pptr from 'puppeteer'
      
      (async () => {
          const browser = await pptr.launch({ headless: false })
          const page = await browser.newPage()
          await page.setViewport({ width: 1080, height: 1024 })
          await page.goto('https://developer.mozilla.org/zh-CN/')
      
        	// XPath é€‰æ‹©å™¨
          const textContent = await page.locator('::-p-xpath((//*[@class="tile-container"]/div/h3/a)[1])')
            .map(el => el.textContent)
            .wait()
          console.log(textContent)
      
          await page.screenshot({ path: 'screenshot.png' })
          await browser.close()
      })()
      ```

   2. æ–‡æœ¬é€‰æ‹©å™¨ï¼ˆ`-p-text`ï¼‰ï¼š

      ```javascript
      import pptr from 'puppeteer'
      
      (async () => {
          const browser = await pptr.launch({ headless: false })
          const page = await browser.newPage()
          await page.setViewport({ width: 1080, height: 1024 })
          await page.goto('https://developer.mozilla.org/zh-CN/')
      		
        	// æ–‡æœ¬é€‰æ‹©å™¨
          const textContent = await page.locator('::-p-text(Developer essentials: JavaScript console methods)')
          	.map(el => el.textContent)
          	.wait()
      		console.log(textContent)
      
          await page.screenshot({ path: 'screenshot.png' })
          await browser.close()
      })()
      ```

   3. ARIA é€‰æ‹©å™¨ï¼ˆ`-p-aria`ï¼‰ï¼š

      ```javascript
      import pptr from 'puppeteer'
      
      (async () => {
          const browser = await pptr.launch({ headless: false })
          const page = await browser.newPage()
          await page.setViewport({ width: 1080, height: 1024 })
          await page.goto('https://developer.mozilla.org/zh-CN/')
      
        	// æ— éšœç¢å±žæ€§é€‰æ‹©å™¨
          const innerHTML = await page.locator('::-p-aria(MDN homepage)')
            .map(el => el.innerHTML)
            .wait()
          console.log(innerHTML)
      
          await page.screenshot({ path: 'screenshot.png' })
          await browser.close()
      })()
      ```

   4. Pierce é€‰æ‹©å™¨ï¼ˆ`pierce/`ï¼‰ï¼š

      ```javascript
      import pptr from 'puppeteer'
      
      (async () => {
          const browser = await pptr.launch({ headless: false })
          const page = await browser.newPage()
          await page.setViewport({ width: 1080, height: 1024 })
          await page.goto('https://mdn.github.io/web-components-examples/composed-composed-path/')
        
        	// ç©¿é€ shadow DOM é€‰æ‹©å™¨ï¼Œæ·±åº¦ç»„åˆå™¨
          const textContent = await page.locator('& >>> p')
          	.map(el => el.textContent)
          	.wait()
          console.log(textContent)
      
          await page.screenshot({ path: 'screenshot.png' })
          await browser.close()
      })()
      ```

   5. è‡ªå®šä¹‰é€‰æ‹©å™¨ï¼š

      ```javascript
      import puppeteer, { Puppeteer } from "puppeteer"
      
      (async () => {
          // æ³¨å†Œ class é€‰æ‹©å™¨ 
          Puppeteer.registerCustomQueryHandler('class', {
              queryOne: (node, selector) => {
                  return node.querySelector(`.${selector}`)
              },
              queryAll: (node, selector) => {
                  return [...node.querySelectorAll(`.${selector}`)]
              }
          })
      
          const browser = await puppeteer.launch()
          const page = await browser.newPage()
          await page.goto("https://developer.mozilla.org/zh-CN/")
      
          // ä½¿ç”¨ class é€‰æ‹©å™¨
          const innerHTML = await page.locator('::-p-class(tile-title)').map(el => el.innerText).wait()
          console.log(innerHTML)
      
          await browser.close()
      })()
      ```

      

2. Shadow DOM é€‰æ‹©å™¨ï¼šCSS é€‰æ‹©å™¨ä¸å…è®¸ç©¿é€ Shadow DOMï¼Œå› æ­¤ï¼ŒPuppeteer åœ¨ CSS é€‰æ‹©å™¨è¯­æ³•ä¸­æ·»åŠ äº†ä¸¤ä¸ªç»„åˆå™¨ï¼Œå…è®¸åœ¨ Shadow DOM ä¸­è¿›è¡Œæœç´¢ã€‚

   1. `>>>` æ·±åº¦ç»„åˆå™¨ï¼šç±»ä¼¼äºŽ CSS åŽä»£ç»„åˆå™¨ï¼ˆç”¨å•ç©ºæ ¼è¡¨ç¤ºï¼Œä¾‹å¦‚ `div button`ï¼‰ï¼›
   2. `>>>>` æ·±åº¦å­ç»„åˆå™¨ï¼šç±»ä¼¼äºŽ CSS å­ç»„åˆå™¨ï¼ˆç”¨ `>` è¡¨ç¤ºï¼Œä¾‹å¦‚ `div > button`ï¼‰ï¼›

3. å¸¦å‰ç¼€é€‰æ‹©å™¨è¯­æ³•ï¼š`${nonCssSelectorName}/${nonCssSelector}` ä¸ºæ—§è¯­æ³•ï¼Œå…è®¸ä¸€æ¬¡è¿è¡Œä¸€ä¸ªéž CSS é€‰æ‹©å™¨ï¼Œä¸å…è®¸ç»„åˆå¤šä¸ªé€‰æ‹©å™¨ï¼Œåˆ‡ä¸å†æŽ¨èä½¿ç”¨ã€‚

   1. é€šè¿‡æ–‡æœ¬é€‰æ‹©å™¨åŒ¹é…å…ƒç´ ï¼Œå¹¶è¿”å›žè¯¥å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼š

      ```javascript
      // æ–‡æœ¬é€‰æ‹©å™¨
      const textContent = await page.locator('text/Developer essentials: JavaScript console methods')
        .map(el => el.textContent)
        .wait()
      console.log(textContent)
      ```

   2. é€šè¿‡ XPath é€‰æ‹©å™¨åŒ¹é…å…ƒç´ ï¼Œå¹¶è¿”å›žè¯¥å…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼š

      ```javascript
      // XPath é€‰æ‹©å™¨
      const textContent = await page.locator('xpath/(//*[@class="tile-container"]/div/h3/a)[1]')
         .map(el => el.textContent)
         .wait()
      console.log(textContent)
      ```

   3. é€šè¿‡æ— éšœç¢é€‰æ‹©å™¨åŒ¹é…å…ƒç´ ï¼Œå¹¶è¿”å›žè¯¥å…ƒç´ çš„ HTML ç»“æž„ï¼š

      ```javascript
      // æ— éšœç¢å±žæ€§é€‰æ‹©å™¨
      const innerHTML = await page.locator('aria/MDN homepage')
         .map(el => el.innerHTML)
         .wait()
      console.log(innerHTML)
      ```

   4. é€šè¿‡ Pierce é€‰æ‹©å™¨åŒ¹é… shadow DOM å…ƒç´ ï¼Œå¹¶è¿”å›žç¬¬ä¸€ä¸ªå…ƒç´ çš„æ–‡æœ¬å†…å®¹ï¼š

      ```javascript
      // ç©¿é€ shadow DOM é€‰æ‹©å™¨
      const textContent = await page.locator('pierce/p')
      	.map(el => el.textContent)
      	.wait()
      console.log(textContent)
      ```


## JavaScript æ‰§è¡Œå™¨ï¼š

Puppeteer è¿è¡Œåœ¨ Puppeteer é©±åŠ¨çš„é¡µé¢ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œ JavaScript å‡½æ•°ã€‚

åœ¨ç¤ºä¾‹ä¸­é€šè¿‡ç¼–å†™ JavaScript å‡½æ•°æ¥èŽ·å– MDN ç½‘é¡µä¸­çš„æŒ‡å®šå…ƒç´ ï¼š

```javascript
import puppeteer from "puppeteer"

(async () => {
    const browser = await puppeteer.launch()
    const page = await browser.newPage()
    await page.goto("https://developer.mozilla.org/zh-CN/")

  	// èŽ·å–ç¬¬ä¸€ä¸ª h1 å…ƒç´ 
    const innerHTML = await page.evaluate(() => document.querySelector('h1').innerHTML)
    console.log(innerHTML)
  
    await browser.close()
})()
```

é‡æž„æ­¤å‡½æ•°ä»¥æ”¯æŒå‚æ•°ä¼ é€’ï¼Œçµæ´»èŽ·å–å…ƒç´ ï¼š

```JavaScript
const innerHTML = await page.evaluate(
    (selector) => document.querySelector(selector).innerHTML,
    'h1'
)
```

å¦‚æžœæ­¤å‡½æ•°è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼ŒPuppeteer ä¼šå°†å…¶åºåˆ—åŒ–ä¸º JSON å¹¶åœ¨è„šæœ¬ç«¯å¯¹é½é‡å»ºã€‚æ­¤è¿‡ç¨‹å¯èƒ½ä¼šå¾—åˆ°ä¸æ­£ç¡®çš„ç»“æžœï¼Œä¸ºäº†å¤„ç†è¿”å›žçš„å¯¹è±¡ï¼ŒPuppeteer æä¾›äº†ä¸€ç§é€šè¿‡å¼•ç”¨è¿”å›žå¯¹è±¡çš„æ–¹æ³•ï¼š

```javascript
const handle = await page.evaluateHandle(
    (selector) => document.querySelector(selector),
    'h1'
)
console.log(handle instanceof ElementHandle)
```

## ç½‘ç»œè¯·æ±‚æ—¥å¿—ï¼š

Puppeteer é»˜è®¤ç›‘å¬æ‰€æœ‰ç½‘ç»œçš„è¯·æ±‚å’Œå“åº”ï¼Œå¹¶åœ¨é¡µé¢ä¸Šå‘å‡ºç½‘ç»œäº‹ä»¶ã€‚

```javascript
import puppeteer from "puppeteer"

(async () => {

    const browser = await puppeteer.launch()
    const page = await browser.newPage()
    await page.goto("https://developer.mozilla.org/zh-CN/")

    page.on("request", request => {
        console.log(request.url())
    })

    page.on("respone", respone => {
        console.log(respone.url())
    })
})()
```

