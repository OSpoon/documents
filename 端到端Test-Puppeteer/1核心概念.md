## 👋 Hi, Nice to meet you ~

我是小鑫同学，在北京工作的一位前端开发工程师。我擅长使用 [Vue.js](https://cn.vuejs.org/)、 [Angular](https://angular.cn/)、 [Typescript](https://www.typescriptlang.org/) 和 [Node.js](https://www.nodejs.com.cn/) 构建 [Web](https://developer.mozilla.org/zh-CN/docs/Web) 应用程序和网站。同时我也是一位乐于分享的程序员，我经常利用休息时间写写技术文章、分享自己经验及学习心得。

近两年主要利用 [MicroApp](https://micro-zoe.github.io/micro-app/) 微前端框架维护和迭代公司的项目，保证历史的 [Angular](https://angular.cn/) 工程逐步向 [Vue.js](https://cn.vuejs.org/) 的平稳迁移。

座右铭: 😇 所有付出都将是沉淀，所有美好终会如期而至

# 核心概念

* 浏览器管理
* 页面交互
* JavaScript Execution
* 网络侦听

## 浏览器管理：

1. **启动浏览器**

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
     	// 启动浏览器
       const browser = await puppeteer.launch()
       const page = await browser.newPage()
   })()
   ```

2. **关闭浏览器**

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.launch()
       const page = await browser.newPage()
       // 关闭浏览器
       await browser.close()
   })()
   ```

3. **上下文**：用来隔离自动化任务中 Cookie 和 本地存储共享的问题，当上下文关闭时所关联的页面会一同关闭；

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.launch()
       // Cookie 和 本地存储只会在此上下文中共享
       const context = await browser.createBrowserContext()
       
       const page1 = await context.newPage()
       const page2 = await context.newPage()
   
       await context.close()
   })()
   ```

4. **上下文权限**：例如在第一次访问高德地图时浏览器会提示你手动开启定位权限，如遇到类似情况，就可以执行 `overridePermissions()` 函数提前配置权限；

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.launch({
           headless: false,
       })
       const context = await browser.defaultBrowserContext()
       
       const url = 'https://ditu.amap.com/'
       await context.overridePermissions(url, ['geolocation'])
       
       const page = await context.newPage()
       await page.goto(url)
   })()
   ```

5. 连接到正在运行的浏览器

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
     	// 携带远程调试端口参数打开第一个浏览器窗口，并导航到如下地址获取 webSocketDebuggerUrl
       const browser = await puppeteer.launch({
           headless: false,
           args: ['--remote-debugging-port=9222']
       })
       const page = await browser.newPage()
       await page.goto('http://localhost:9222/json/version')
   })()
   ```

   ```javascript
   import puppeteer from 'puppeteer'
   
   (async () => {
       const browser = await puppeteer.connect({
           headless: false,
           browserWSEndpoint: '' // 将 webSocketDebuggerUrl 填写到此，并连接第一个浏览器窗口
       })
   
       await browser.newPage()
     	// 任务处理完毕后可断开连接而不会关闭浏览器窗口
     	browser.disconnect()
   })()
   ```

## 页面交互：

Puppeteer 允许通过鼠标、触摸事件和键盘输入与页面上的元素进行交互。通过，首选 CSS 选择器查询 DOM 元素，然后对元素调用操作。除 CSS 选择器被 Puppeteer 默认 API 支持以外，还提供了自动以选择器语法，允许使用 XPath、Text、Accessibility 属性查找元素并访问 Shadow DOM。

除了对选择的元素发出鼠标或键盘事件外，还可以直接使用 `page.mouse` 、`page.keyboard` 和 `page.touchscreen` API;

### Locators：


